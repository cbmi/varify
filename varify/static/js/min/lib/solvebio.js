(function(e,t){typeof define=="function"&&define.amd?define(["module"],t):typeof exports=="object"?module.exports=t():e.returnExports=t()})(this,function(e){var t="0.0.1",n={};e&&typeof e.config=="function"&&(n=e.config());var r=n.debug||!1,i=n.appId,s=n.accessToken,o=n.apiHost?n.apiHost.replace(/\/?$/,""):"https://api.solvebio.com",u=n.dashboardOrigin||"*",a=function(e){var t=[];for(var n in e){var r=n,i=e[n];t.push(typeof i=="object"?a(i,r):encodeURIComponent(r)+"="+encodeURIComponent(i))}return t.join("&")},f=function(e,t){return e+(e.indexOf("?")>0?"&":"?")+a(t)},l={},c=!1,h=function(e,t){e._iframe&&e._iframe.contentWindow?e._iframe.contentWindow.postMessage(JSON.stringify(t),u):d.error("Could not postMessage to dashboard: "+e._name)},p=function(){if(c)return;c=!0,window.addEventListener("message",function(e){e=e.originalEvent||e;if(u!=="*"&&u!==e.origin)return!1;var t;try{t=e.data&&e.data.length>0?JSON.parse(e.data):{};if(t==={})return!1}catch(n){return!1}if(t.name in l){var r=l[t.name];if(!r._loaded){d.debug('Dashboard "'+t.name+'" loaded!'),r._loaded=!0,r.postMessage({settings:r._settings});for(var i=0;i<r._onLoad.length;++i)r._onLoad[i](r)}t.height&&(d.debug("Dashboard updating height to: "+t.height+"px"),r._iframe.style.height=t.height+"px")}},!1)},d={debug:function(e){r&&window.console.debug("[SolveBio] "+e)},error:function(e){window.console.error("[SolveBio] "+e)}},v={version:function(){return t},setDebug:function(e){r=!!e},apiHost:function(){return o},setApiHost:function(e){d.debug("Setting API host to "+e),o=e.replace(/\/?$/,"")},setAppId:function(e){i=e},getAppId:function(){return i},setAccessToken:function(e){s=e},getAccessToken:function(){return s},rest:function(e,t,n,r,i){e=e.toUpperCase();var u=""+o+"/"+t.replace(/^\/?/,"");n=n||{},r=r||function(){},i=i||function(){},!s||(n.access_token=s),e==="GET"||e==="HEAD"?(u=f(u,n),n=null):n=JSON.stringify(n,null,4);var a=new XMLHttpRequest;return a.onreadystatechange=function(){if(a.readyState===4&&a.status!==200)try{i(JSON.parse(a.responseText))}catch(e){i(a.responseText)}if(a.readyState===4&&a.status===200)try{r(JSON.parse(a.responseText))}catch(e){i(a.responseText)}},d.debug("Sending "+e+" request to "+u),a.open(e,u,!0),a.setRequestHeader("Content-type","application/json"),a.send(n),a},Dashboards:{all:function(){return l},create:function(e,t,n,i){var u,a,c;return e in l?l[e]:(u=document.getElementById(n.replace("#","")),u?(p(),i=i?i:{},i.name=e,i.debug=r,o&&(i.apiHost=o),s&&(i.accessToken=s),a=document.createElement("iframe"),a.setAttribute("src",f(t,{name:e,debug:r})),a.setAttribute("id",e+"-iframe"),a.setAttribute("name",e),a.setAttribute("width","100%"),a.setAttribute("height","100%"),a.setAttribute("scrolling","no"),a.setAttribute("frameborder","0"),a.style.border="none",a.style.width="100%",a.style.minHeight="800px",u.insertBefore(a,u.firstChild),c={_name:e,_id:e+"-iframe",_iframe:a,_loaded:!1,_settings:i,_onLoad:[],postMessage:function(e){h(this,e)},ready:function(e){this._loaded?e(this):this._onLoad.push(e)}},l[e]=c,c):(d.error('Dashboards.create() could not find target by ID "'+n+'"'),!1))},get:function(e){return l[e]},"delete":function(e){if(e in l){var t=l[e]._iframe;delete l[e];try{t.parentNode.removeChild(t)}catch(n){}}else d.error('Could not delete dashboard "'+e+'": not found.')}}},m=function(e){v[e.toLowerCase()]=function(){return this.rest.apply(this,[e].concat([].slice.call(arguments)))}},g=["GET","PUT","POST","DELETE"];for(var y=0;y<g.length;y++)m(g[y]);return v})