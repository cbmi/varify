define(["jquery","underscore","backbone","marionette","../../utils","../variant"],function(e,t,n,r,i,s){var o=r.Layout.extend({className:"result-details-modal modal hide",maxExpandableHeight:300,showLessText:"Show Less...",showMoreText:"Show More...",template:"varify/modals/result",ui:{expandableRows:"[data-target=expandable-details-row]",expandLinks:"[data-target=expand-collapse-link]"},regions:{summary:"[data-target=summary]",effects:"[data-target=effects]",phenotypes:"[data-target=phenotypes]"},events:{"click [data-action=close-result-modal]":"close","click @ui.expandLinks":"toggleExpandedState"},close:function(){this.$el.modal("hide")},onRender:function(){this.$el.modal({show:!1,keyboard:!1,backdrop:"static"})},_checkForOverflow:function(){t.each(e(".expandable-details-item"),function(t){var n,r=!1;for(var i=0;i<t.children.length;i++){n=t.children[i];if(n.offsetTop+n.offsetHeight>this.maxExpandableHeight){r=!0;break}}r?e(t).find(".expand-collapse-container").show():e(t).find(".expand-collapse-container").hide()},this)},toggleExpandedState:function(t){var n,r;n=e(t.target),r=n.closest("[data-target=expandable-details-row]"),n.text()===this.showMoreText?(r.find("[data-target=expand-collapse-link]").text(this.showLessText),r.css("height","auto").css("overflow","visible")):(r.find("[data-target=expand-collapse-link]").text(this.showMoreText),r.css("height",this.maxExpandableHeight).css("overflow","hidden"))},open:function(e){this.model=e,this.summary.show(new s.Summary({model:this.model})),this.effects.show(new s.Effects({collection:new n.Collection(i.groupEffectsByType(t.filter(this.model.get("variant").effects,function(e){return e.transcript!==null})))})),this.phenotypes.show(new s.Phenotypes({collection:new n.Collection(i.groupPhenotypesByType(this.model.get("variant")))})),this.$el.modal("show"),this.ui.expandableRows.css("height",""+this.maxExpandableHeight+"px").css("overflow","hidden"),this.ui.expandLinks.text(this.showMoreText),this._checkForOverflow()}});return{ResultDetails:o}})