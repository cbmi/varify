define(["jquery","underscore","backbone","marionette","../../models"],function(e,t,n,r,i){var s=r.ItemView.extend({tagName:"li",template:"varify/variant/assessment-metrics/user-popover-item"}),o=r.CollectionView.extend({className:"unstyled",tagName:"ul",template:function(){},itemView:s}),u=r.ItemView.extend({tagName:"li",template:"varify/variant/assessment-metrics/percentage-item",ui:{popover:"[data-target=user-popover]"},onRender:function(){var e=new o({collection:new n.Collection(this.model.get("users"))});this.ui.popover.attr("data-content",e.render().el.outerHTML)}}),a=r.CompositeView.extend({template:"varify/variant/assessment-metrics/percentages",itemView:u,itemViewContainer:"[data-target=items]",templateHelpers:function(){return{title:this.options.title}}}),f=r.Layout.extend({template:"varify/variant/assessment-metrics",ui:{empty:"[data-target=empty-message]",error:"[data-target=error-message]",loading:"[data-target=loading-indicator]",metrics:"[data-target=metrics-container]"},regions:{categories:"[data-target=categories]",pathogenicities:"[data-target=pathogenicities]"},modelEvents:{error:"onError",request:"onRequest",sync:"onSync"},popoverSelector:"[data-target=user-popover]",initialize:function(){t.bindAll(this,"onError","onRequest","onSync","hidePopover");if(!this.options.variantId)throw new Error("Variant ID Required");this.model=new i.AssessmentMetrics({},{variantId:this.options.variantId}),e(document).on("click",this.hidePopover)},hidePopover:function(t){e(this.popoverSelector).not(t.target).popover("hide")},onError:function(){this.ui.empty.hide(),this.ui.error.show(),this.ui.loading.hide(),this.ui.metrics.hide()},onRequest:function(){this.ui.empty.hide(),this.ui.error.hide(),this.ui.loading.show(),this.ui.metrics.hide()},onSync:function(){this.ui.empty.hide(),this.ui.error.hide(),this.ui.loading.hide(),this.ui.metrics.hide(),this.model.get("num_assessments")?(this.categories.show(new a({collection:new n.Collection(this.model.get("categories")),title:"Categories"})),this.pathogenicities.show(new a({collection:new n.Collection(this.model.get("pathogenicities")),title:"Pathogenicities"})),this.$el.find(this.popoverSelector).popover({container:"#result-details-modal",html:!0,title:"Users who made this call"}),this.ui.metrics.show()):this.ui.empty.show()},onRender:function(){this.model.fetch()}});return{AssessmentMetrics:f}})